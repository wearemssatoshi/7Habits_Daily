<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>7Habits Daily v1.0</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="7Habits Daily">
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Inter:wght@400;500;600&family=Noto+Sans+JP:wght@400;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --white: #FFFFFF;
            --off-white: #FAFAFA;
            --light-gray: #F5F5F5;
            --navy: #1E3A5F;
            --navy-dark: #0F2A4A;
            --gold: #C9A962;
            --gold-light: rgba(201, 169, 98, 0.15);
            --gold-glow: rgba(201, 169, 98, 0.3);
            --text-dark: #1E3A5F;
            --text-gray: #6B7B8C;
            --border: rgba(30, 58, 95, 0.1);
            --success: #22C55E;
            --warning: #F59E0B;
            --danger: #EF4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--off-white);
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(12px);
            position: sticky;
            top: 0;
            z-index: 9999;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.04);
        }

        h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 0.05em;
            color: var(--navy);
        }

        .header-sub {
            font-family: 'Montserrat', sans-serif;
            font-size: 10px;
            color: var(--gold);
            letter-spacing: 0.2em;
            margin-top: 4px;
            font-weight: 500;
        }

        .user-badge {
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            color: var(--text-gray);
            margin-top: 10px;
            padding: 5px 14px;
            background: var(--light-gray);
            border-radius: 20px;
            display: inline-block;
        }

        .streak-display {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(135deg, rgba(201, 169, 98, 0.15), rgba(201, 169, 98, 0.05));
            border: 1px solid var(--gold);
            padding: 6px 14px;
            border-radius: 25px;
            margin-top: 10px;
            margin-left: 8px;
        }

        .streak-icon {
            font-size: 16px;
        }

        .streak-count {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 13px;
            color: var(--gold);
        }

        .streak-label {
            font-family: 'Montserrat', sans-serif;
            font-size: 9px;
            letter-spacing: 0.1em;
            color: var(--text-gray);
        }

        main {
            flex-grow: 1;
            padding: 22px;
            overflow-y: auto;
            padding-bottom: 100px;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 11px;
            color: var(--gold);
            letter-spacing: 0.25em;
            text-transform: uppercase;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }

        .section-title::before,
        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--gold-light), transparent);
        }

        /* LOGIN SCREEN */
        .login-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 30px 25px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
        }

        .login-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: 0.05em;
            color: var(--navy);
        }

        .login-sub {
            font-size: 13px;
            color: var(--text-gray);
            margin-bottom: 25px;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .input-label {
            font-family: 'Montserrat', sans-serif;
            font-size: 10px;
            color: var(--gold);
            letter-spacing: 0.15em;
            margin-bottom: 8px;
            display: block;
            font-weight: 600;
        }

        .text-input {
            width: 100%;
            background: var(--light-gray);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 14px 16px;
            color: var(--text-dark);
            font-family: 'Inter', sans-serif;
            font-size: 15px;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--gold);
        }

        /* PRACTICE CARD */
        .practice-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        .practice-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), var(--navy));
        }

        .practice-habit-badge {
            display: inline-block;
            background: var(--navy);
            color: var(--white);
            padding: 4px 12px;
            border-radius: 20px;
            font-family: 'Montserrat', sans-serif;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.1em;
            margin-bottom: 12px;
        }

        .practice-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 10px;
        }

        .practice-description {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-gray);
        }

        .practice-source {
            margin-top: 15px;
            font-size: 11px;
            color: var(--gold);
            font-family: 'Montserrat', sans-serif;
        }

        /* DAILY CHECKIN */
        .checkin-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
        }

        .checkin-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--navy);
        }

        .checkin-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid var(--border);
        }

        .checkin-item:last-child {
            border-bottom: none;
        }

        .checkin-label {
            font-size: 14px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkin-label .icon {
            font-size: 20px;
        }

        .checkin-toggle {
            display: flex;
            gap: 8px;
        }

        .toggle-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: var(--light-gray);
            color: var(--text-gray);
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toggle-btn.selected {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        /* DECLARATION */
        .declaration-card {
            background: linear-gradient(145deg, var(--navy), var(--navy-dark));
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            color: var(--white);
        }

        .declaration-label {
            font-family: 'Montserrat', sans-serif;
            font-size: 10px;
            letter-spacing: 0.2em;
            color: var(--gold);
            margin-bottom: 12px;
        }

        .declaration-text {
            font-size: 16px;
            line-height: 1.8;
            font-weight: 500;
        }

        .declaration-date {
            margin-top: 15px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* BUTTONS */
        .btn-main {
            background: var(--gold);
            color: var(--navy-dark);
            border: none;
            padding: 16px;
            border-radius: 50px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 14px;
            letter-spacing: 0.1em;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--gold-glow);
            transition: all 0.2s;
            margin-top: 15px;
        }

        .btn-main:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .btn-main:hover:not(:disabled) {
            box-shadow: 0 6px 20px var(--gold-glow);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-gray);
            padding: 12px;
            border-radius: 50px;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            width: 100%;
            cursor: pointer;
            margin-top: 10px;
        }

        /* BOTTOM NAV */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--white);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 12px 0 calc(12px + env(safe-area-inset-bottom));
            z-index: 9999;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-gray);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.2s;
            font-size: 10px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
        }

        .nav-item.active {
            color: var(--gold);
        }

        .nav-item .icon {
            font-size: 22px;
        }

        /* CARDS LIST */
        .cards-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .card-mini {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .card-mini:hover {
            border-color: var(--gold);
        }

        .card-mini-habit {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--navy);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }

        .card-mini-content {
            flex: 1;
        }

        .card-mini-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--navy);
            margin-bottom: 4px;
        }

        .card-mini-desc {
            font-size: 12px;
            color: var(--text-gray);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-mini-fav {
            font-size: 20px;
            color: var(--border);
            cursor: pointer;
        }

        .card-mini-fav.active {
            color: var(--gold);
        }

        /* FILTER TABS */
        .filter-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }

        .filter-tab {
            padding: 8px 16px;
            border-radius: 20px;
            background: var(--light-gray);
            border: 1px solid var(--border);
            color: var(--text-gray);
            font-family: 'Montserrat', sans-serif;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-tab.active {
            background: var(--navy);
            border-color: var(--navy);
            color: var(--white);
        }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            color: var(--text-gray);
            cursor: pointer;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            background: var(--light-gray);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 14px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 14px;
            color: var(--text-dark);
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: var(--gold);
        }

        /* SUCCESS STATE */
        .success-message {
            text-align: center;
            padding: 40px 20px;
        }

        .success-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .success-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 10px;
        }

        .success-sub {
            font-size: 14px;
            color: var(--text-gray);
        }

        /* 30 DAY CHALLENGE CALENDAR */
        .challenge-calendar {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 15px;
        }

        .challenge-day {
            aspect-ratio: 1;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--light-gray);
            border: 2px solid var(--border);
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.2s;
        }

        .challenge-day.success {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .challenge-day.fail {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        .challenge-day.today {
            border-color: var(--gold);
            box-shadow: 0 0 0 3px var(--gold-glow);
        }

        .challenge-day.future {
            opacity: 0.4;
            cursor: default;
        }

        .challenge-day-num {
            font-size: 16px;
            font-weight: 700;
        }

        .challenge-day-icon {
            font-size: 12px;
            margin-top: 2px;
        }
    </style>
</head>

<body>
    <header>
        <h1>7Habits Daily</h1>
        <div class="header-sub">DAILY PRACTICE TRACKER</div>
        <div id="userInfo" style="display: none;">
            <span class="user-badge" id="userName">...</span>
            <span class="streak-display">
                <span class="streak-icon">ğŸ”¥</span>
                <span class="streak-count" id="streakCount">0</span>
                <span class="streak-label">DAYS</span>
            </span>
        </div>
        <!-- ä»Šæœˆã®å®£èª“ -->
        <div id="monthlyDeclarationHeader"
            style="display:none; margin-top:10px; background:rgba(255,255,255,0.15); border-radius:10px; padding:10px; cursor:pointer;"
            onclick="showScreen('profile')">
            <div style="font-size:10px; color:var(--gold); letter-spacing:1px; margin-bottom:4px;">ğŸ“œ ä»Šæœˆã®å®£èª“</div>
            <div id="headerDeclaration" style="font-size:13px; line-height:1.4; max-height:40px; overflow:hidden;">æœªè¨­å®š
            </div>
        </div>
    </header>

    <main>
        <!-- LOGIN SCREEN -->
        <div id="loginScreen" class="screen active">
            <div class="login-card">
                <div class="login-title">Welcome</div>
                <div class="login-sub">7ã¤ã®ç¿’æ…£ã‚’æ¯æ—¥å®Ÿè·µã—ã‚ˆã†</div>
                <div class="input-group">
                    <label class="input-label">EMAIL</label>
                    <input type="email" class="text-input" id="loginEmail" placeholder="email@example.com">
                </div>
                <div class="input-group">
                    <label class="input-label">PIN</label>
                    <input type="password" class="text-input" id="loginPin" placeholder="4æ¡ã®PIN" maxlength="4">
                </div>
                <button class="btn-main" onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>
                <button class="btn-secondary" onclick="showRegister()">æ–°è¦ç™»éŒ²</button>
            </div>
        </div>

        <!-- HOME SCREEN -->
        <div id="homeScreen" class="screen">
            <div class="section-title">TODAY'S PRACTICE</div>
            <div class="practice-card" id="todayCard">
                <div class="practice-habit-badge" id="cardHabitBadge">ç¬¬1ã®ç¿’æ…£</div>
                <div class="practice-title" id="cardTitle">ä¸»ä½“çš„ã§ã‚ã‚‹</div>
                <div class="practice-description" id="cardDescription">åˆºæ¿€ã¨åå¿œã®é–“ã‚’æ„è­˜ã—ã€è‡ªåˆ†ã®é¸æŠã«è²¬ä»»ã‚’æŒã¡ã¾ã—ã‚‡ã†ã€‚</div>
                <div class="practice-source" id="cardSource">å‡ºå…¸ï¼šç¬¬3å›</div>
            </div>

            <div class="section-title">DAILY CHECK-IN</div>
            <div class="checkin-card">
                <div class="checkin-title">âœ¨ ä»Šæ—¥ã®4ã¤ã®å´é¢</div>
                <div class="checkin-item">
                    <div class="checkin-label"><span class="icon">ğŸ’ª</span> è‚‰ä½“ï¼ˆé‹å‹•ãƒ»ç¡çœ ãƒ»æ „é¤Šï¼‰</div>
                    <div class="checkin-toggle">
                        <button class="toggle-btn" data-aspect="physical" onclick="toggleCheckin(this)">âœ“</button>
                    </div>
                </div>
                <div class="checkin-item">
                    <div class="checkin-label"><span class="icon">ğŸ§˜</span> ç²¾ç¥ï¼ˆç‘æƒ³ãƒ»èª­æ›¸ãƒ»è‡ªç„¶ï¼‰</div>
                    <div class="checkin-toggle">
                        <button class="toggle-btn" data-aspect="spiritual" onclick="toggleCheckin(this)">âœ“</button>
                    </div>
                </div>
                <div class="checkin-item">
                    <div class="checkin-label"><span class="icon">ğŸ“š</span> çŸ¥æ€§ï¼ˆå­¦ç¿’ãƒ»è¨ˆç”»ãƒ»åŸ·ç­†ï¼‰</div>
                    <div class="checkin-toggle">
                        <button class="toggle-btn" data-aspect="intellectual" onclick="toggleCheckin(this)">âœ“</button>
                    </div>
                </div>
                <div class="checkin-item">
                    <div class="checkin-label"><span class="icon">ğŸ¤</span> ç¤¾ä¼šãƒ»æƒ…ç·’ï¼ˆå¥‰ä»•ãƒ»å…±æ„Ÿï¼‰</div>
                    <div class="checkin-toggle">
                        <button class="toggle-btn" data-aspect="social" onclick="toggleCheckin(this)">âœ“</button>
                    </div>
                </div>
            </div>
            <button class="btn-main" id="checkinBtn" onclick="submitCheckin()" disabled>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å®Œäº†</button>
        </div>

        <!-- DECLARATION SCREEN -->
        <div id="declarationScreen" class="screen">
            <div class="section-title">MY DECLARATION</div>
            <div class="declaration-card">
                <div class="declaration-label">è‡ªå·±å®£èª“</div>
                <div class="declaration-text" id="declarationText">
                    ã¾ã è‡ªå·±å®£èª“ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>
                    å®Ÿè·µä¼šã§æ±ºã‚ãŸã€Œå–ã‚Šçµ„ã¿ãŸã„ã“ã¨ã€ã‚’ç™»éŒ²ã—ã¾ã—ã‚‡ã†ã€‚
                </div>
                <div class="declaration-date" id="declarationDate"></div>
            </div>
            <button class="btn-main" onclick="openDeclarationModal()">âœï¸ å®£èª“ã‚’ç·¨é›†</button>
        </div>

        <!-- CARDS SCREEN -->
        <div id="cardsScreen" class="screen">
            <div class="section-title">100 PRACTICE CARDS</div>
            <div class="filter-tabs" id="filterTabs">
                <div class="filter-tab active" data-habit="all" onclick="filterCards('all')">ã™ã¹ã¦</div>
                <div class="filter-tab" data-habit="0" onclick="filterCards(0)">åŸºæœ¬åŸå‰‡</div>
                <div class="filter-tab" data-habit="1" onclick="filterCards(1)">ç¿’æ…£1</div>
                <div class="filter-tab" data-habit="2" onclick="filterCards(2)">ç¿’æ…£2</div>
                <div class="filter-tab" data-habit="3" onclick="filterCards(3)">ç¿’æ…£3</div>
                <div class="filter-tab" data-habit="4" onclick="filterCards(4)">ç¿’æ…£4</div>
                <div class="filter-tab" data-habit="5" onclick="filterCards(5)">ç¿’æ…£5</div>
                <div class="filter-tab" data-habit="6" onclick="filterCards(6)">ç¿’æ…£6</div>
                <div class="filter-tab" data-habit="7" onclick="filterCards(7)">ç¿’æ…£7</div>
            </div>
            <div class="cards-grid" id="cardsGrid"></div>
        </div>

        <!-- 30æ—¥é–“ãƒ†ã‚¹ãƒˆ SCREEN -->
        <div id="challenge30Screen" class="screen">
            <div class="section-title">ğŸ¯ ä¸»ä½“çš„30æ—¥é–“ãƒ†ã‚¹ãƒˆ</div>

            <!-- ãƒ†ã‚¹ãƒˆèª¬æ˜ã‚«ãƒ¼ãƒ‰ -->
            <div class="practice-card" id="challengeIntroCard">
                <div class="practice-habit-badge">ç¬¬1ã®ç¿’æ…£</div>
                <div class="practice-title">ä¸»ä½“æ€§ã®30æ—¥é–“ãƒãƒ£ãƒ¬ãƒ³ã‚¸</div>
                <div class="practice-description">
                    30æ—¥é–“ã€åˆºæ¿€ã¨åå¿œã®é–“ã§ä¸»ä½“çš„ãªé¸æŠã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚<br>
                    æ¯æ—¥ã®æŒ¯ã‚Šè¿”ã‚Šã‚’è¨˜éŒ²ã—ã€è‡ªåˆ†ã®å¤‰åŒ–ã‚’è¦³å¯Ÿã—ã¦ãã ã•ã„ã€‚
                </div>
            </div>

            <!-- ãƒ†ã‚¹ãƒˆçŠ¶æ…‹ -->
            <div id="challengeNotStarted">
                <div class="checkin-card">
                    <div class="checkin-title">ğŸ“… ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’é–‹å§‹</div>
                    <p style="font-size:14px; color:var(--text-gray); margin-bottom:15px;">
                        ä»Šæ—¥ã‹ã‚‰30æ—¥é–“ã€ä¸»ä½“çš„ãªé¸æŠã‚’æ„è­˜ã—ã¦éã”ã—ã¾ã—ã‚‡ã†ã€‚<br>
                        æ¯æ—¥ã€Œä¸»ä½“çš„ã ã£ãŸã‹ã€ã‚’æŒ¯ã‚Šè¿”ã‚Šã€è¨˜éŒ²ã—ã¾ã™ã€‚
                    </p>
                    <button class="btn-main" onclick="startChallenge()">ğŸš€ 30æ—¥é–“ãƒ†ã‚¹ãƒˆé–‹å§‹</button>
                </div>
            </div>

            <!-- ãƒ†ã‚¹ãƒˆé€²è¡Œä¸­ -->
            <div id="challengeInProgress" style="display:none;">
                <!-- é€²æ—ã‚µãƒãƒªãƒ¼ -->
                <div class="checkin-card" style="text-align:center; padding:25px;">
                    <div style="font-size:48px; font-weight:700; color:var(--gold); font-family:'Montserrat',sans-serif;"
                        id="challengeDay">1</div>
                    <div style="font-size:12px; color:var(--text-gray); letter-spacing:0.2em; margin-bottom:10px;">DAY /
                        30</div>
                    <div style="display:flex; justify-content:center; gap:20px; margin-top:15px;">
                        <div>
                            <div style="font-size:24px; font-weight:700; color:var(--success);" id="successCount">0
                            </div>
                            <div style="font-size:10px; color:var(--text-gray);">ä¸»ä½“çš„ãªæ—¥</div>
                        </div>
                        <div>
                            <div style="font-size:24px; font-weight:700; color:var(--text-gray);" id="pendingCount">30
                            </div>
                            <div style="font-size:10px; color:var(--text-gray);">æ®‹ã‚Š</div>
                        </div>
                    </div>
                </div>

                <!-- 30æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
                <div class="checkin-card">
                    <div class="checkin-title">ğŸ“Š 30æ—¥é–“ã®è¨˜éŒ²</div>
                    <div class="challenge-calendar" id="challengeCalendar"></div>
                </div>

                <!-- ä»Šæ—¥ã®æŒ¯ã‚Šè¿”ã‚Š -->
                <div class="checkin-card" id="todayReflectionCard">
                    <div class="checkin-title" style="display:flex; justify-content:space-between; align-items:center;">
                        <span>âœï¸ ä»Šæ—¥ã®æŒ¯ã‚Šè¿”ã‚Š</span>
                        <span id="reflectionStatusBadge"
                            style="display:none; background:var(--success); color:white; font-size:10px; padding:4px 10px; border-radius:15px;">âœ…
                            è¨˜éŒ²æ¸ˆã¿</span>
                    </div>
                    <!-- è¨˜éŒ²æ¸ˆã¿è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
                    <div id="reflectionViewMode" style="display:none;">
                        <div
                            style="background:var(--light-gray); border-radius:10px; padding:15px; margin-bottom:15px;">
                            <div style="display:flex; align-items:center; gap:8px; margin-bottom:10px;">
                                <span id="viewProactiveIcon" style="font-size:24px;">ğŸ˜Š</span>
                                <span id="viewProactiveText"
                                    style="font-size:14px; font-weight:600; color:var(--navy);">ä¸»ä½“çš„ã«éã”ã›ãŸ</span>
                            </div>
                            <div style="font-size:12px; color:var(--text-gray); margin-bottom:5px;">ä»Šæ—¥ã®å­¦ã³ãƒ»æ°—ã¥ã</div>
                            <div id="viewNoteText" style="font-size:14px; color:var(--navy); line-height:1.6;">ãƒ¡ãƒ¢ãªã—
                            </div>
                        </div>
                        <button class="btn-secondary" onclick="enableReflectionEdit()">âœï¸ ç·¨é›†ã™ã‚‹</button>
                    </div>
                    <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
                    <div id="reflectionEditMode">
                        <div style="margin-bottom:15px;">
                            <div style="font-size:13px; color:var(--text-gray); margin-bottom:10px;">ä»Šæ—¥ã¯ä¸»ä½“çš„ã«éã”ã›ã¾ã—ãŸã‹ï¼Ÿ
                            </div>
                            <div style="display:flex; gap:10px;">
                                <button class="toggle-btn" id="proactiveYes" onclick="setTodayProactive(true)"
                                    style="flex:1;">ğŸ˜Š ã¯ã„</button>
                                <button class="toggle-btn" id="proactiveNo" onclick="setTodayProactive(false)"
                                    style="flex:1;">ğŸ˜” ã„ã„ãˆ</button>
                            </div>
                        </div>
                        <div>
                            <div style="font-size:13px; color:var(--text-gray); margin-bottom:10px;">ä»Šæ—¥ã®å­¦ã³ãƒ»æ°—ã¥ã</div>
                            <textarea id="todayNote" placeholder="ä¾‹ï¼šæœã®æ¸‹æ»ã§ã‚¤ãƒ©ã‚¤ãƒ©ã—ãã†ã«ãªã£ãŸãŒã€ä¸€æ™‚åœæ­¢ã—ã¦éŸ³æ¥½ã‚’æ¥½ã—ã‚€é¸æŠã‚’ã—ãŸã€‚"
                                style="min-height:80px;"></textarea>
                        </div>
                        <button class="btn-main" onclick="saveTodayReflection()" id="saveReflectionBtn"
                            disabled>æŒ¯ã‚Šè¿”ã‚Šã‚’ä¿å­˜</button>
                    </div>
                </div>
            </div>

            <!-- ãƒ†ã‚¹ãƒˆå®Œäº† -->
            <div id="challengeCompleted" style="display:none;">
                <div class="success-message">
                    <div class="success-icon">ğŸ†</div>
                    <div class="success-title">30æ—¥é–“ãƒ†ã‚¹ãƒˆå®Œäº†ï¼</div>
                    <div class="success-sub" id="completionMessage">ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼30æ—¥é–“ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’é”æˆã—ã¾ã—ãŸã€‚</div>
                </div>
                <div class="checkin-card">
                    <div class="checkin-title">ğŸ“Š çµæœã‚µãƒãƒªãƒ¼</div>
                    <div class="checkin-item">
                        <div class="checkin-label">ä¸»ä½“çš„ãªæ—¥</div>
                        <div id="finalSuccessCount">0æ—¥</div>
                    </div>
                    <div class="checkin-item">
                        <div class="checkin-label">æˆåŠŸç‡</div>
                        <div id="successRate">0%</div>
                    </div>
                </div>
                <button class="btn-secondary" onclick="resetChallenge()">ğŸ”„ ã‚‚ã†ä¸€åº¦ãƒãƒ£ãƒ¬ãƒ³ã‚¸</button>
            </div>
        </div>

        <!-- PROFILE SCREEN -->
        <div id="profileScreen" class="screen">
            <div class="section-title">PROFILE</div>
            <div class="checkin-card">
                <div class="checkin-title">ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±</div>
                <div class="checkin-item">
                    <div class="checkin-label">åå‰</div>
                    <div id="profileName">-</div>
                </div>
                <div class="checkin-item">
                    <div class="checkin-label">é€£ç¶šæ—¥æ•°</div>
                    <div id="profileStreak">0æ—¥</div>
                </div>
                <div class="checkin-item">
                    <div class="checkin-label">ç·ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³</div>
                    <div id="profileTotal">0å›</div>
                </div>
            </div>

            <!-- ä»Šæœˆã®å®£èª“ -->
            <div class="section-title">ğŸ“œ ä»Šæœˆã®å®£èª“</div>
            <div class="checkin-card">
                <div style="margin-bottom:15px;">
                    <div style="font-size:12px; color:var(--text-gray); margin-bottom:8px;" id="currentMonthLabel">
                        2026å¹´1æœˆ</div>
                    <textarea id="monthlyDeclarationInput" placeholder="ä»Šæœˆã®å®Ÿè·µä¼šã§æ±ºã‚ãŸã€Œå–ã‚Šçµ„ã¿ãŸã„ã“ã¨ã€ã‚’è¨˜éŒ²ã—ã¾ã—ã‚‡ã†"
                        style="min-height:80px;"></textarea>
                </div>
                <button class="btn-main" onclick="saveMonthlyDeclaration()">ä¿å­˜</button>
            </div>

            <!-- å®£èª“å±¥æ­´ -->
            <div class="section-title">ğŸ“š éå»ã®å®£èª“</div>
            <div id="declarationHistory" class="checkin-card">
                <div style="color:var(--text-gray); font-size:13px; text-align:center;">ã¾ã å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</div>
            </div>

            <button class="btn-secondary" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        </div>
    </main>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav" id="bottomNav" style="display: none;">
        <div class="nav-item active" onclick="showScreen('home')">
            <span class="icon">ğŸ </span>
            HOME
        </div>
        <div class="nav-item" onclick="showScreen('challenge30')">
            <span class="icon">ğŸ¯</span>
            30æ—¥
        </div>
        <div class="nav-item" onclick="showScreen('cards')">
            <span class="icon">ğŸƒ</span>
            CARDS
        </div>
        <div class="nav-item" onclick="showScreen('profile')">
            <span class="icon">ğŸ‘¤</span>
            ME
        </div>
    </nav>

    <!-- DECLARATION MODAL -->
    <div class="modal-overlay" id="declarationModal">
        <div class="modal-content">
            <div class="login-title">è‡ªå·±å®£èª“ã‚’ç·¨é›†</div>
            <div class="login-sub" style="margin-bottom: 20px;">å®Ÿè·µä¼šã§æ±ºã‚ãŸã€Œå–ã‚Šçµ„ã¿ãŸã„ã“ã¨ã€ã‚’è¨˜éŒ²ã—ã¾ã—ã‚‡ã†</div>
            <textarea id="declarationInput" placeholder="ä¾‹ï¼šæ¯æ—¥ã€åˆºæ¿€ã¨åå¿œã®é–“ã§ä¸€æ™‚åœæ­¢ã™ã‚‹&#10;ä¾‹ï¼šé€±ã«ä¸€åº¦ã€å½¹å‰²ã”ã¨ã®ç›®æ¨™ã‚’è¨­å®šã™ã‚‹"></textarea>
            <button class="btn-main" onclick="saveDeclaration()">ä¿å­˜</button>
            <button class="btn-secondary" onclick="closeDeclarationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        </div>
    </div>

    <!-- DAY DETAIL MODAL -->
    <div class="modal-overlay" id="dayDetailModal">
        <div class="modal-content" style="text-align:center;">
            <div style="font-size:48px; margin-bottom:10px;" id="dayDetailIcon">ğŸ˜Š</div>
            <div class="login-title" id="dayDetailTitle">Day 1</div>
            <div id="dayDetailDate" style="font-size:12px; color:var(--text-gray); margin-bottom:15px;">2026-01-28</div>
            <div
                style="background:var(--light-gray); border-radius:10px; padding:15px; margin-bottom:20px; text-align:left;">
                <div style="font-size:13px; color:var(--text-gray); margin-bottom:5px;">ä»Šæ—¥ã®å­¦ã³ãƒ»æ°—ã¥ã</div>
                <div id="dayDetailNote" style="font-size:14px; color:var(--navy); line-height:1.6;">ãƒ¡ãƒ¢ãŒã‚ã‚Šã¾ã›ã‚“</div>
            </div>
            <button class="btn-secondary" onclick="closeDayDetailModal()">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <script>
        // ========================================
        // 7Habits Daily - Frontend Logic
        // ========================================

        const APP_VERSION = 'v1.0';
        let currentUser = null;
        let practiceCards = [];
        let checkinState = { physical: false, spiritual: false, intellectual: false, social: false };

        // GAS Backend URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzWy123CTBdO7Sd87VfTi3lK5kVmzjwujJp0GIUr-ZAyUgP4QiscLIcPvX9oGB3fWh0/exec';

        // ----------------------
        // INITIALIZATION
        // ----------------------
        async function init() {
            await loadPracticeCards();
            checkLocalSession();
        }

        async function loadPracticeCards() {
            // ç›´æ¥åŸ‹ã‚è¾¼ã¿ï¼ˆCORSã‚¨ãƒ©ãƒ¼å›é¿ï¼‰
            practiceCards = [
                { id: 1, habit: 1, title: "åˆºæ¿€ã¨åå¿œã®é–“ã‚’æ„è­˜ã™ã‚‹", description: "ä»Šæ—¥ã€ä½•ã‹ã«åå¿œã™ã‚‹å‰ã«ä¸€æ™‚åœæ­¢ã—ã€è‡ªåˆ†ã®é¸æŠã‚’æ„è­˜ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬3å›" },
                { id: 2, habit: 1, title: "ä¸»ä½“çš„ãªè¨€è‘‰ã‚’ä½¿ã†", description: "ã€Œã€œã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€ã‚’ã€Œç§ã¯ã€œã‚’é¸æŠã™ã‚‹ã€ã«è¨€ã„æ›ãˆã‚‹ç·´ç¿’ã‚’ã—ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 3, habit: 1, title: "å½±éŸ¿ã®è¼ªã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹", description: "ä»Šæ—¥ã€è‡ªåˆ†ãŒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ãã‚‹ã“ã¨ã ã‘ã«é›†ä¸­ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬3å›" },
                { id: 4, habit: 1, title: "é–¢å¿ƒã®è¼ªã‚’æ‰‹æ”¾ã™", description: "è‡ªåˆ†ã§ã¯ã©ã†ã«ã‚‚ã§ããªã„ã“ã¨ã«æ™‚é–“ã‚„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ä½¿ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ", source: "ç¬¬3å›" },
                { id: 5, habit: 1, title: "è‡ªè¦šã®åŠ›ã‚’ä½¿ã†", description: "è‡ªåˆ†è‡ªèº«ã‚’å®¢è¦³çš„ã«è¦‹ã¤ã‚ã‚‹æ™‚é–“ã‚’å–ã‚Šã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬3å›" },
                { id: 6, habit: 1, title: "æƒ³åƒåŠ›ã‚’åƒã‹ã›ã‚‹", description: "ç¾çŠ¶ã‚’è¶…ãˆãŸå¯èƒ½æ€§ã‚’é ­ã®ä¸­ã§æƒ³åƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 7, habit: 1, title: "è‰¯å¿ƒã«å¾“ã†", description: "ä»Šæ—¥ã®è¡Œå‹•ã¯ã€è‡ªåˆ†ã®ä¾¡å€¤è¦³ã¨ä¸€è‡´ã—ã¦ã„ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬3å›" },
                { id: 8, habit: 1, title: "æ„å¿—ã‚’ç™ºæ®ã™ã‚‹", description: "å‘¨ã‚Šã«æµã•ã‚Œãšã€è‡ªè¦šã«åŸºã¥ã„ã¦è¡Œå‹•ã§ãã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬3å›" },
                { id: 9, habit: 1, title: "åå¿œçš„ãªè¨€è‘‰ã‚’é¿ã‘ã‚‹", description: "ã€Œã§ããªã„ã€ã€Œã‚ã®äººã®ã›ã„ã€ã¨è¨€ã„ãã†ã«ãªã£ãŸã‚‰ç«‹ã¡æ­¢ã¾ã‚Šã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 10, habit: 1, title: "å°ã•ãªç´„æŸã‚’å®ˆã‚‹", description: "è‡ªåˆ†ã¸ã®å°ã•ãªç´„æŸã‚’ä¸€ã¤ã—ã¦ã€ãã‚Œã‚’å®ˆã‚Šã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 11, habit: 1, title: "ã‚»ãƒ«ãƒ•ãƒ»ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚’è¦‹ç›´ã™", description: "ã€Œè‡ªåˆ†ã¯ã€œã ã€ã¨ã„ã†æ€ã„è¾¼ã¿ã‚’ç–‘ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 12, habit: 1, title: "æ¨¡ç¯„ã«ãªã‚‹", description: "æ‰¹åˆ¤ã™ã‚‹ã®ã§ã¯ãªãã€è‡ªã‚‰ãŒè‰¯ã„æ‰‹æœ¬ã«ãªã‚Šã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 13, habit: 1, title: "å…‰ã‚’ç…§ã‚‰ã™äººã«ãªã‚‹", description: "è£ãäººã§ã¯ãªãã€å…‰ã‚’ç…§ã‚‰ã™äººã«ãªã‚‹ã“ã¨ã‚’æ„è­˜ã—ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 14, habit: 1, title: "å•é¡Œè§£æ±ºè€…ã«ãªã‚‹", description: "å•é¡Œã‚’ä½œã‚Šå‡ºã™ã®ã§ã¯ãªãã€è§£æ±ºã®ä¸€åŠ©ã«ãªã‚Šã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬3å›" },
                { id: 15, habit: 2, title: "çµ‚ã‚ã‚Šã‚’æ€ã„æã", description: "ä»Šæ—¥ã¨ã„ã†ä¸€æ—¥ã‚’ã€äººç”Ÿã®æœ€å¾Œã‚’å¿µé ­ã«ç½®ã„ã¦å§‹ã‚ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 16, habit: 2, title: "å¼”è¾ã‚’æƒ³åƒã™ã‚‹", description: "ã‚ãªãŸã®è‘¬å„€ã§ã€èª°ã«ä½•ã¨è¨€ã‚ã‚ŒãŸã„ã§ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 17, habit: 2, title: "æ­£ã—ã„å£ã«æ¢¯å­ã‚’ã‹ã‘ã‚‹", description: "åŠ¹ç‡ã‚ˆãç™»ã‚‹ã“ã¨ã‚ˆã‚Šã€æ­£ã—ã„æ–¹å‘ã«å‘ã‹ã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬4å›" },
                { id: 18, habit: 2, title: "ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªã™ã‚‹", description: "ã‚ãªãŸã®å€‹äººæ†²æ³•ã‚’ä»Šæ—¥ç¢ºèªã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 19, habit: 2, title: "å½¹å‰²ã‚’æ˜ç¢ºã«ã™ã‚‹", description: "ã‚ãªãŸã®äººç”Ÿã«ãŠã‘ã‚‹é‡è¦ãªå½¹å‰²ã¯ä½•ã§ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 20, habit: 2, title: "å„å½¹å‰²ã®ç›®æ¨™ã‚’æŒã¤", description: "ãã‚Œãã‚Œã®å½¹å‰²ã§é”æˆã—ãŸã„é•·æœŸç›®æ¨™ã‚’æ„è­˜ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 21, habit: 2, title: "çŸ¥çš„å‰µé€ ã‚’è¡Œã†", description: "è¡Œå‹•ã™ã‚‹å‰ã«ã€é ­ã®ä¸­ã§ãƒ“ã‚¸ãƒ§ãƒ³ã‚’æãã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 22, habit: 2, title: "ä¸­å¿ƒã‚’ç¢ºèªã™ã‚‹", description: "ã‚ãªãŸã®äººç”Ÿã®ä¸­å¿ƒã«ã‚ã‚‹ã‚‚ã®ã¯ä½•ã§ã™ã‹ï¼ŸåŸå‰‡ä¸­å¿ƒã§ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 23, habit: 2, title: "å®‰å®šã‚’æ„Ÿã˜ã‚‹", description: "å¿ƒã®å®‰ã‚‰ãã¨è‡ªå°Šå¿ƒã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 24, habit: 2, title: "æŒ‡é‡ã‚’æŒã¤", description: "äººç”Ÿã®æ–¹å‘æ€§ã‚’æ±ºã‚ã‚‹åˆ¤æ–­åŸºæº–ã‚’æ„è­˜ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 25, habit: 2, title: "çŸ¥æµã‚’ç£¨ã", description: "ãƒãƒ©ãƒ³ã‚¹ã®ã¨ã‚ŒãŸåˆ¤æ–­ãŒã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 26, habit: 2, title: "åŠ›ã‚’ç™ºæ®ã™ã‚‹", description: "æ±ºã‚ãŸã“ã¨ã‚’å®Ÿè¡Œã™ã‚‹åŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 27, habit: 2, title: "å³è„³ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹", description: "äº”æ„Ÿã‚’ãƒ•ãƒ«ã«åƒã‹ã›ã¦ã€ç†æƒ³ã®å§¿ã‚’æƒ³åƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬4å›" },
                { id: 28, habit: 2, title: "è„šæœ¬ã‚’æ›¸ãç›´ã™", description: "ä¸ãˆã‚‰ã‚ŒãŸè„šæœ¬ã§ã¯ãªãã€è‡ªåˆ†ã§äººç”Ÿã®è„šæœ¬ã‚’æ›¸ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬4å›" },
                { id: 29, habit: 3, title: "æœ€å„ªå…ˆäº‹é …ã‚’å„ªå…ˆã™ã‚‹", description: "å¤§äº‹ã‚’å°äº‹ã®çŠ ç‰²ã«ã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 30, habit: 3, title: "ç¬¬â…¡é ˜åŸŸã«é›†ä¸­ã™ã‚‹", description: "ç·Šæ€¥ã§ã¯ãªã„ãŒé‡è¦ãªã“ã¨ã«æ™‚é–“ã‚’ä½¿ã„ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 31, habit: 3, title: "é€±é–“è¨ˆç”»ã‚’ç«‹ã¦ã‚‹", description: "å½¹å‰²â†’ç›®æ¨™â†’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é †ã§é€±é–“è¨ˆç”»ã‚’ç«‹ã¦ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 32, habit: 3, title: "å½¹å‰²ã”ã¨ã®ç›®æ¨™ã‚’è¨­å®šã™ã‚‹", description: "ä»Šé€±ã€å„å½¹å‰²ã§é”æˆã—ãŸã„æˆæœã‚’1ã€œ2ã¤æ±ºã‚ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 33, habit: 3, title: "å„ªå…ˆäº‹é …ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã™ã‚‹", description: "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å„ªå…ˆé †ä½ã‚’ã¤ã‘ã‚‹ã®ã§ã¯ãªãã€å„ªå…ˆäº‹é …ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬5å›" },
                { id: 34, habit: 3, title: "ç¬¬â… é ˜åŸŸã‚’æ¸›ã‚‰ã™", description: "ç·Šæ€¥ã‹ã¤é‡è¦ãªå±æ©Ÿå¯¾å¿œã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã€äºˆé˜²ã«æ™‚é–“ã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬5å›" },
                { id: 35, habit: 3, title: "ç¬¬â…¢é ˜åŸŸã‚’è¦‹åˆ†ã‘ã‚‹", description: "è¦‹ã›ã‹ã‘ã®ç·Šæ€¥ã«æƒ‘ã‚ã•ã‚Œã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 36, habit: 3, title: "ç¬¬â…£é ˜åŸŸã‚’é¿ã‘ã‚‹", description: "æš‡ã¤ã¶ã—ã‚„é€ƒé¿ã«æ™‚é–“ã‚’ä½¿ã„ã™ãã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 37, habit: 3, title: "äººã«ä»»ã›ã‚‹ï¼ˆãƒ‡ãƒªã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰", description: "å…¨é¢çš„ãªãƒ‡ãƒªã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè·µã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 38, habit: 3, title: "æœ›ã‚€æˆæœã‚’æ˜ç¢ºã«ã™ã‚‹", description: "ä»»ã›ã‚‹ã¨ãã€ä½•ã‚’é”æˆã™ã‚‹ã‹ã‚’æ˜ç¢ºã«ä¼ãˆã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 39, habit: 3, title: "ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ç¤ºã™", description: "å®ˆã‚‹ã¹ãåŸºæº–ã‚„ãƒ«ãƒ¼ãƒ«ã‚’æ˜ç¢ºã«ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 40, habit: 3, title: "ãƒªã‚½ãƒ¼ã‚¹ã‚’æ˜ç¢ºã«ã™ã‚‹", description: "ä½¿ãˆã‚‹äººå“¡ã€è³‡é‡‘ã€æŠ€è¡“ã‚’ä¼ãˆã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 41, habit: 3, title: "ãƒãƒ¼ã¨è¨€ã†", description: "å„ªå…ˆåº¦ã®ä½ã„ã“ã¨ã«ãƒãƒ¼ã¨è¨€ãˆã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬5å›" },
                { id: 42, habit: 3, title: "P/PCãƒãƒ©ãƒ³ã‚¹ã‚’æ„è­˜ã™ã‚‹", description: "æˆæœã‚’å‡ºã—ãªãŒã‚‰ã€èƒ½åŠ›ã‚’ç¶­æŒãƒ»å‘ä¸Šã•ã›ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 43, habit: 4, title: "Win-Winã‚’è€ƒãˆã‚‹", description: "å…¨å“¡ãŒæº€è¶³ã§ãã‚‹è§£æ±ºç­–ã‚’æ¢ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬6å›" },
                { id: 44, habit: 4, title: "è±Šã‹ã•ãƒã‚¤ãƒ³ãƒ‰", description: "ãƒ‘ã‚¤ã¯ååˆ†ã«å¤§ãã„ã¨ä¿¡ã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬6å›" },
                { id: 45, habit: 4, title: "å‹‡æ°—ã¨æ€ã„ã‚„ã‚Šã®ãƒãƒ©ãƒ³ã‚¹", description: "è‡ªåˆ†ã®æ„è¦‹ã‚’è¨€ã„ãªãŒã‚‰ã€ç›¸æ‰‹ã‚‚å°Šé‡ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬6å›" },
                { id: 46, habit: 4, title: "No Dealã®é¸æŠè‚¢ã‚’æŒã¤", description: "Win-WinãŒç„¡ç†ãªã‚‰ã€å–å¼•ã—ãªã„é¸æŠè‚¢ã‚‚ã‚ã‚Šã¾ã™ã€‚", source: "ç¬¬6å›" },
                { id: 47, habit: 4, title: "ä¿¡é ¼å£åº§ã«é ã‘å…¥ã‚Œã‚‹", description: "å¤§åˆ‡ãªäººã¸ã®ä¿¡é ¼æ®‹é«˜ã‚’å¢—ã‚„ã™è¡Œå‹•ã‚’ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬6å›" },
                { id: 48, habit: 4, title: "ç›¸æ‰‹ã‚’ç†è§£ã™ã‚‹", description: "ç›¸æ‰‹ã‚’æœ¬å½“ã«ç†è§£ã—ã‚ˆã†ã¨ã™ã‚‹å§¿å‹¢ã¯ã€æœ€ã‚‚é‡è¦ãªé ã‘å…¥ã‚Œã§ã™ã€‚", source: "ç¬¬6å›" },
                { id: 49, habit: 4, title: "å°ã•ãªã“ã¨ã‚’æ°—é£ã†", description: "äººé–“é–¢ä¿‚ã§ã¯ã€å°ã•ãªã“ã¨ãŒå¤§ããªæ„å‘³ã‚’æŒã¡ã¾ã™ã€‚", source: "ç¬¬6å›" },
                { id: 50, habit: 4, title: "ç´„æŸã‚’å®ˆã‚‹", description: "ç´„æŸã‚’å®ˆã‚‹ã“ã¨ã¯ã€å¤§ããªé ã‘å…¥ã‚Œã«ãªã‚Šã¾ã™ã€‚", source: "ç¬¬6å›" },
                { id: 51, habit: 4, title: "æœŸå¾…ã‚’æ˜ç¢ºã«ã™ã‚‹", description: "æœ€åˆã«æœŸå¾…ã‚’æ˜ç¢ºã«ã™ã‚Œã°ã€å¾Œã®ãƒˆãƒ©ãƒ–ãƒ«ã‚’é˜²ã’ã¾ã™ã€‚", source: "ç¬¬6å›" },
                { id: 52, habit: 4, title: "èª å®Ÿã•ã‚’ç¤ºã™", description: "è¨€è¡Œä¸€è‡´ã§ã€èª å®Ÿã•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬6å›" },
                { id: 53, habit: 4, title: "å¿ƒã‹ã‚‰è¬ã‚‹", description: "å¼•ãå‡ºã—ã¦ã—ã¾ã£ãŸã¨ãã«ã¯ã€å¿ƒã‹ã‚‰è¬ã‚Šã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬6å›" },
                { id: 54, habit: 4, title: "ç„¡æ¡ä»¶ã®æ„›", description: "è¦‹è¿”ã‚Šã‚’æ±‚ã‚ãšã€æœ¬å¿ƒã‹ã‚‰ç›¸æ‰‹ã‚’æ„›ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬6å›" },
                { id: 55, habit: 5, title: "ã¾ãšç†è§£ã«å¾¹ã™ã‚‹", description: "ç›¸æ‰‹ã®è©±ã‚’ã€ç†è§£ã—ã‚ˆã†ã¨ã—ã¦è´ãã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬8å›" },
                { id: 56, habit: 5, title: "å…±æ„Ÿã«ã‚ˆã‚‹å‚¾è´", description: "ç›¸æ‰‹ã®èº«ã«ãªã£ã¦ã€å¿ƒã§è´ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬8å›" },
                { id: 57, habit: 5, title: "è‡ªå™ä¼çš„åå¿œã‚’é¿ã‘ã‚‹", description: "è©•ä¾¡ã€æ¢ã‚Šã€åŠ©è¨€ã€è§£é‡ˆã‚’ã›ãšã«è´ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬8å›" },
                { id: 58, habit: 5, title: "ç›¸æ‰‹ã®è¨€è‘‰ã‚’ç¹°ã‚Šè¿”ã™", description: "å‚¾è´ã®ç¬¬ä¸€æ®µéšï¼šç›¸æ‰‹ã®è¨€è‘‰ã‚’ãã®ã¾ã¾ç¹°ã‚Šè¿”ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬8å›" },
                { id: 59, habit: 5, title: "ç›¸æ‰‹ã®è¨€è‘‰ã‚’è¨€ã„æ›ãˆã‚‹", description: "å‚¾è´ã®ç¬¬äºŒæ®µéšï¼šç›¸æ‰‹ã®è¨€è‘‰ã‚’è‡ªåˆ†ã®è¨€è‘‰ã«ç½®ãæ›ãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬8å›" },
                { id: 60, habit: 5, title: "ç›¸æ‰‹ã®æ°—æŒã¡ã‚’è¨€è‘‰ã«ã™ã‚‹", description: "å‚¾è´ã®ç¬¬ä¸‰æ®µéšï¼šç›¸æ‰‹ã®æ„Ÿæƒ…ã‚’è¨€è‘‰ã«ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬8å›" },
                { id: 61, habit: 5, title: "è¨€è‘‰ã¨æ°—æŒã¡ã®ä¸¡æ–¹ã‚’åæ˜ ã™ã‚‹", description: "å‚¾è´ã®ç¬¬å››æ®µéšï¼šè¨€è‘‰ã®ç½®ãæ›ãˆã¨æ°—æŒã¡ã®è¨€èªåŒ–ã‚’åŒæ™‚ã«è¡Œã„ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬8å›" },
                { id: 62, habit: 5, title: "å¿ƒç†çš„ãªç©ºæ°—ã‚’é€ã‚‹", description: "ç›¸æ‰‹ã«ç†è§£ã•ã‚Œã¦ã„ã‚‹ã€èªã‚ã‚‰ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã•ã›ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬8å›" },
                { id: 63, habit: 5, title: "äººæ ¼ãŒã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åœŸå°", description: "ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã ã‘ã§ãªãã€äººæ ¼ã‚’ç£¨ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬8å›" },
                { id: 64, habit: 5, title: "ãã—ã¦ç†è§£ã•ã‚Œã‚‹", description: "ç›¸æ‰‹ã‚’ç†è§£ã—ãŸå¾Œã€è‡ªåˆ†ã‚’ç†è§£ã—ã¦ã‚‚ã‚‰ã†åŠªåŠ›ã‚’ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬9å›" },
                { id: 65, habit: 5, title: "ã‚¨ãƒˆã‚¹â†’ãƒ‘ãƒˆã‚¹â†’ãƒ­ã‚´ã‚¹", description: "äººæ ¼â†’æ„Ÿæƒ…â†’è«–ç†ã®é †ã§ä¼ãˆã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬9å›" },
                { id: 66, habit: 5, title: "ä¸€å¯¾ä¸€ã®æ™‚é–“ã‚’å–ã‚‹", description: "å¤§åˆ‡ãªäººã¨ä¸€å¯¾ä¸€ã§å‘ãåˆã†æ™‚é–“ã‚’ä½œã‚Šã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬9å›" },
                { id: 67, habit: 5, title: "ä¿¡é ¼é–¢ä¿‚ã‚’ç¯‰ã„ã¦ã‹ã‚‰è©±ã™", description: "ä¿¡é ¼æ®‹é«˜ãŒååˆ†ã«ã‚ã‚‹çŠ¶æ…‹ã§è©±ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬9å›" },
                { id: 68, habit: 6, title: "ã‚·ãƒŠã‚¸ãƒ¼ã‚’å‰µã‚Šå‡ºã™", description: "1+1ã‚’3ä»¥ä¸Šã«ã™ã‚‹å”åŠ›ãŒã§ãã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 69, habit: 6, title: "é•ã„ã‚’å°Šé‡ã™ã‚‹", description: "è‡ªåˆ†ã¨é•ã†æ„è¦‹ã‚’ã€æˆé•·ã®æ©Ÿä¼šã¨ã—ã¦æ­“è¿ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 70, habit: 6, title: "ç¬¬3ã®æ¡ˆã‚’æ¢ã™", description: "ç™½ã‹é»’ã‹ã§ã¯ãªãã€ã‚ˆã‚Šè‰¯ã„ç¬¬3ã®æ¡ˆã‚’æ¢ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 71, habit: 6, title: "è¬™è™šã•ã‚’æŒã¤", description: "è‡ªåˆ†ã®ã‚‚ã®ã®è¦‹æ–¹ã«ã¯é™ç•ŒãŒã‚ã‚‹ã“ã¨ã‚’èªã‚ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 72, habit: 6, title: "å¿ƒã‚’é–‹ã", description: "æ–°ã—ã„å¯èƒ½æ€§ã‚„é¸æŠè‚¢ã‚’å—ã‘å…¥ã‚Œã‚‹å§¿å‹¢ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 73, habit: 6, title: "ã‚·ãƒŠã‚¸ãƒ¼çš„ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³", description: "é«˜ã„ä¿¡é ¼ã¨å”åŠ›ã§ã€Win-Winã‚’å‰µã‚Šå‡ºã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 74, habit: 6, title: "é˜²è¡›çš„åå¿œã‚’é¿ã‘ã‚‹", description: "è‡ªåˆ†ã®ç«‹å ´ã‚’å®ˆã‚‹ã“ã¨ã ã‘ã«å›ºåŸ·ã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 75, habit: 6, title: "å¦¥å”ã§çµ‚ã‚ã‚‰ãªã„", description: "ãŠäº’ã„ã«å°‘ã—ãšã¤è­²ã‚‹å¦¥å”ã§ã¯ãªãã€ã‚ˆã‚Šé«˜ã„æ¬¡å…ƒã®è§£ã‚’æ¢ã—ã¾ã—ã‚‡ã†ã€‚", source: "ç¬¬10å›" },
                { id: 76, habit: 6, title: "å‰µé€ çš„ãªå”åŠ›", description: "ãƒãƒ¼ãƒ ã§å‰µé€ åŠ›ã‚’ç™ºæ®ã—ã€ä¸€äººã§ã¯ã§ããªã„ã“ã¨ã‚’é”æˆã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 77, habit: 6, title: "åŠ›ã®å ´ã‚’å¤‰ãˆã‚‹", description: "æŠ‘æ­¢åŠ›ã‚’æ¨é€²åŠ›ã«å¤‰ãˆã‚‹ã‚·ãƒŠã‚¸ãƒ¼ã‚’å‰µã‚Šå‡ºã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬10å›" },
                { id: 78, habit: 7, title: "åˆƒã‚’ç ”ã", description: "ä»Šæ—¥ã€4ã¤ã®å´é¢ã®ã©ã‚Œã‹ã‚’å†æ–°å†ç”Ÿã™ã‚‹æ™‚é–“ã‚’å–ã‚Šã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 79, habit: 7, title: "è‚‰ä½“ã‚’é›ãˆã‚‹", description: "é‹å‹•ã€æ „é¤Šã€ç¡çœ ã«æ°—ã‚’é…ã‚Šã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 80, habit: 7, title: "ç²¾ç¥ã‚’ç£¨ã", description: "ç‘æƒ³ã€èª­æ›¸ã€è‡ªç„¶ã«è§¦ã‚Œã‚‹æ™‚é–“ã‚’å–ã‚Šã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 81, habit: 7, title: "çŸ¥æ€§ã‚’é«˜ã‚ã‚‹", description: "å­¦ç¿’ã€è¨ˆç”»ã€åŸ·ç­†ãªã©ã€çŸ¥çš„æ´»å‹•ã‚’ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 82, habit: 7, title: "ç¤¾ä¼šãƒ»æƒ…ç·’ã‚’è‚²ã¦ã‚‹", description: "å¥‰ä»•ã€å…±æ„Ÿã€ã‚·ãƒŠã‚¸ãƒ¼ãªã©ã€äººé–“é–¢ä¿‚ã‚’è‚²ã¦ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 83, habit: 7, title: "æ¯æ—¥ã®ç§çš„æˆåŠŸ", description: "è‚‰ä½“ãƒ»ç²¾ç¥ãƒ»çŸ¥æ€§ã®åˆƒã‚’ç ”ãæ™‚é–“ã‚’æ¯æ—¥1æ™‚é–“ç¢ºä¿ã—ã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 84, habit: 7, title: "ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹", description: "4ã¤ã®å´é¢ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãç£¨ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 85, habit: 7, title: "ç¶™ç¶šã™ã‚‹", description: "å­¦ã³â†’æ±ºæ„â†’å®Ÿè¡Œã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¶™ç¶šã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 86, habit: 7, title: "æµã‚Œã‚’å¤‰ãˆã‚‹äººã«ãªã‚‹", description: "æ‚ªã„è„šæœ¬ã‚’æ¬¡ä¸–ä»£ã«æ¸¡ã•ãšã€è‡ªåˆ†ã®ä»£ã§å¤‰ãˆã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 87, habit: 7, title: "ä»–è€…ã®å¯èƒ½æ€§ã‚’ä¿¡ã˜ã‚‹", description: "äººã®ã‚ã‚‹ã¹ãå§¿ã‚’è¦‹ã¦æ¥ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 88, habit: 7, title: "ä¸Šå‘ãã®èºæ—‹ã‚’ç™»ã‚‹", description: "å¸¸ã«ã‚ˆã‚Šé«˜ã„æ¬¡å…ƒã‚’ç›®æŒ‡ã—ã€æˆé•·ã—ç¶šã‘ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬11å›" },
                { id: 89, habit: 0, title: "ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚’æ„è­˜ã™ã‚‹", description: "è‡ªåˆ†ã®é ­ã®ä¸­ã®åœ°å›³ï¼ˆãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ï¼‰ã‚’æ„è­˜ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬1å›" },
                { id: 90, habit: 0, title: "åŸå‰‡ä¸­å¿ƒã§ç”Ÿãã‚‹", description: "æ™‚é–“ã‚’è¶…ãˆã¦ä¸å¤‰ã®åŸå‰‡ã«å¾“ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬1å›" },
                { id: 91, habit: 0, title: "ã‚¤ãƒ³ã‚µã‚¤ãƒ‰ãƒ»ã‚¢ã‚¦ãƒˆ", description: "å¤–å´ã§ã¯ãªãã€è‡ªåˆ†ã®å†…é¢ã‹ã‚‰å¤‰åŒ–ã‚’å§‹ã‚ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬1å›" },
                { id: 92, habit: 0, title: "äººæ ¼ä¸»ç¾©ã‚’å®Ÿè·µã™ã‚‹", description: "ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚ˆã‚Šäººæ ¼ã‚’ç£¨ãã“ã¨ã‚’å„ªå…ˆã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬1å›" },
                { id: 93, habit: 0, title: "çŸ¥è­˜ã‚’å¾—ã‚‹", description: "ä½•ã‚’ã™ã‚‹ã‹ã€ãªãœãã†ã™ã‚‹ã‹ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 94, habit: 0, title: "ã‚¹ã‚­ãƒ«ã‚’ç£¨ã", description: "ã©ã†ã‚„ã£ã¦ã™ã‚‹ã‹ã‚’ç¿’å¾—ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 95, habit: 0, title: "æ„æ¬²ã‚’æŒã¤", description: "ãã‚Œã‚’ã—ãŸã„ã¨ã„ã†å‹•æ©ŸãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 96, habit: 0, title: "ç§çš„æˆåŠŸã‹ã‚‰å…¬çš„æˆåŠŸã¸", description: "ã¾ãšè‡ªç«‹ã—ã€ãã®å¾Œã«ç›¸äº’ä¾å­˜ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 97, habit: 0, title: "7ã¤ã®ç¿’æ…£ã‚’æ•™ãˆã‚‹", description: "å­¦ã‚“ã ã“ã¨ã‚’48æ™‚é–“ä»¥å†…ã«èª°ã‹ã«æ•™ãˆã¾ã—ãŸã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 98, habit: 0, title: "æœ¬ã‚’èª­ã¿è¿”ã™", description: "7ã¤ã®ç¿’æ…£ã®æœ¬ã‚’æŠ˜ã«è§¦ã‚Œã¦èª­ã¿è¿”ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 99, habit: 0, title: "åŠ¹æœæ€§ã‚’é«˜ã‚ã‚‹", description: "æˆæœã‚’å‡ºã—ãªãŒã‚‰ã€èƒ½åŠ›ã‚‚é«˜ã‚ã¦ã„ã¾ã™ã‹ï¼Ÿ", source: "ç¬¬2å›" },
                { id: 100, habit: 0, title: "è‡ªå·±å®£èª“ã‚’å®ˆã‚‹", description: "å®Ÿè·µä¼šã§å®£è¨€ã—ãŸã“ã¨ã‚’ã€ä»Šæ—¥ã‚‚å®Ÿè·µã—ã¾ã—ãŸã‹ï¼Ÿ", source: "å®Ÿè·µä¼šå…¨ä½“" }
            ];
            console.log(`Loaded ${practiceCards.length} practice cards`);
        }

        function checkLocalSession() {
            const savedUser = localStorage.getItem('7habits_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
            }
        }

        // ----------------------
        // AUTH
        // ----------------------
        async function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const pin = document.getElementById('loginPin').value.trim();

            if (!email || !pin) {
                alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨PINã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // Try to sync from backend first
            if (SCRIPT_URL) {
                try {
                    const response = await fetch(`${SCRIPT_URL}?action=login&email=${encodeURIComponent(email)}&pin=${encodeURIComponent(pin)}`);
                    const data = await response.json();

                    if (data.success && data.user) {
                        currentUser = data.user;
                        localStorage.setItem('7habits_user', JSON.stringify(currentUser));

                        // Sync challenge data if exists
                        if (data.challenge) {
                            localStorage.setItem('7habits_challenge', JSON.stringify(data.challenge));
                        }

                        showMainApp();
                        return;
                    } else if (data.error) {
                        alert(data.error);
                        return;
                    }
                } catch (e) {
                    console.log('Backend login failed, using local:', e);
                }
            }

            // Fallback to localStorage
            const savedUser = localStorage.getItem('7habits_user');
            if (savedUser) {
                const parsed = JSON.parse(savedUser);
                if (parsed.email === email) {
                    currentUser = parsed;
                    showMainApp();
                    return;
                }
            }

            // New user - create local user
            currentUser = {
                email: email,
                name: email.split('@')[0],
                streak: 0,
                totalCheckins: 0,
                declaration: '',
                declarationDate: ''
            };
            localStorage.setItem('7habits_user', JSON.stringify(currentUser));
            showMainApp();
        }

        async function showRegister() {
            const email = document.getElementById('loginEmail').value.trim();
            const pin = document.getElementById('loginPin').value.trim();
            const name = prompt('è¡¨ç¤ºåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');

            if (!email || !pin || !name) {
                alert('ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // Try to register on backend first
            if (SCRIPT_URL) {
                try {
                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'register',
                            email: email,
                            pin: pin,
                            name: name
                        })
                    });
                    const data = await response.json();

                    if (data.success && data.user) {
                        currentUser = data.user;
                        localStorage.setItem('7habits_user', JSON.stringify(currentUser));
                        showMainApp();
                        alert('ç™»éŒ²å®Œäº†ï¼ã‚ˆã†ã“ã ' + name + ' ã•ã‚“ï¼');
                        return;
                    } else if (data.error) {
                        alert(data.error);
                        return;
                    }
                } catch (e) {
                    console.log('Backend register failed, using local:', e);
                }
            }

            // Fallback to local
            currentUser = {
                email: email,
                name: name,
                streak: 0,
                totalCheckins: 0,
                declaration: '',
                declarationDate: ''
            };
            localStorage.setItem('7habits_user', JSON.stringify(currentUser));
            showMainApp();
        }

        function logout() {
            localStorage.removeItem('7habits_user');
            currentUser = null;
            location.reload();
        }

        // ----------------------
        // MAIN APP
        // ----------------------
        function showMainApp() {
            document.getElementById('loginScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            document.getElementById('bottomNav').style.display = 'flex';
            document.getElementById('userInfo').style.display = 'block';

            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('streakCount').textContent = currentUser.streak || 0;

            showTodayCard();
            updateDeclarationDisplay();
            renderCardsGrid();
            updateProfileScreen();
        }

        function showScreen(screen) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

            document.getElementById(screen + 'Screen').classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // ----------------------
        // TODAY'S CARD
        // ----------------------
        function showTodayCard() {
            if (practiceCards.length === 0) return;

            // Get today's card based on date (consistent daily)
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            const cardIndex = dayOfYear % practiceCards.length;
            const card = practiceCards[cardIndex];

            const habitNames = {
                0: 'åŸºæœ¬åŸå‰‡',
                1: 'ç¬¬1ã®ç¿’æ…£',
                2: 'ç¬¬2ã®ç¿’æ…£',
                3: 'ç¬¬3ã®ç¿’æ…£',
                4: 'ç¬¬4ã®ç¿’æ…£',
                5: 'ç¬¬5ã®ç¿’æ…£',
                6: 'ç¬¬6ã®ç¿’æ…£',
                7: 'ç¬¬7ã®ç¿’æ…£'
            };

            document.getElementById('cardHabitBadge').textContent = habitNames[card.habit] || 'åŸºæœ¬åŸå‰‡';
            document.getElementById('cardTitle').textContent = card.title;
            document.getElementById('cardDescription').textContent = card.description;
            document.getElementById('cardSource').textContent = `å‡ºå…¸ï¼š${card.source}`;
        }

        // ----------------------
        // CHECKIN
        // ----------------------
        function toggleCheckin(btn) {
            const aspect = btn.dataset.aspect;
            checkinState[aspect] = !checkinState[aspect];
            btn.classList.toggle('selected', checkinState[aspect]);

            const allChecked = Object.values(checkinState).every(v => v);
            document.getElementById('checkinBtn').disabled = !allChecked;
        }

        async function submitCheckin() {
            const today = new Date().toISOString().split('T')[0];
            const lastCheckin = localStorage.getItem('7habits_last_checkin');

            if (lastCheckin === today) {
                alert('ä»Šæ—¥ã¯ã™ã§ã«ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ã§ã™ï¼');
                return;
            }

            // Update streak
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toISOString().split('T')[0];

            if (lastCheckin === yesterdayStr) {
                currentUser.streak++;
            } else if (lastCheckin !== today) {
                currentUser.streak = 1;
            }

            currentUser.totalCheckins++;
            localStorage.setItem('7habits_user', JSON.stringify(currentUser));
            localStorage.setItem('7habits_last_checkin', today);

            document.getElementById('streakCount').textContent = currentUser.streak;
            document.getElementById('checkinBtn').textContent = 'âœ“ ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å®Œäº†!';
            document.getElementById('checkinBtn').disabled = true;

            // Reset toggle buttons visual
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.style.pointerEvents = 'none';
            });

            // Sync to backend
            if (SCRIPT_URL) {
                try {
                    await fetch(SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'checkin',
                            email: currentUser.email,
                            date: today,
                            checkin: checkinState
                        })
                    });
                } catch (e) {
                    console.log('Backend sync skipped:', e);
                }
            }

            alert(`ğŸ‰ ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å®Œäº†ï¼\né€£ç¶š ${currentUser.streak} æ—¥ç›®ã§ã™ï¼`);
        }

        // ----------------------
        // DECLARATION
        // ----------------------
        function updateDeclarationDisplay() {
            if (currentUser.declaration) {
                document.getElementById('declarationText').textContent = currentUser.declaration;
                document.getElementById('declarationDate').textContent = `æ›´æ–°: ${currentUser.declarationDate}`;
            }
        }

        function openDeclarationModal() {
            document.getElementById('declarationInput').value = currentUser.declaration || '';
            document.getElementById('declarationModal').classList.add('active');
        }

        function closeDeclarationModal() {
            document.getElementById('declarationModal').classList.remove('active');
        }

        function saveDeclaration() {
            const text = document.getElementById('declarationInput').value.trim();
            if (!text) {
                alert('å®£èª“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            currentUser.declaration = text;
            currentUser.declarationDate = new Date().toLocaleDateString('ja-JP');
            localStorage.setItem('7habits_user', JSON.stringify(currentUser));

            updateDeclarationDisplay();
            closeDeclarationModal();
            alert('è‡ªå·±å®£èª“ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
        }

        // ----------------------
        // CARDS
        // ----------------------
        function renderCardsGrid(filter = 'all') {
            const grid = document.getElementById('cardsGrid');
            grid.innerHTML = '';

            const habitNames = {
                0: 'åŸºæœ¬',
                1: 'H1',
                2: 'H2',
                3: 'H3',
                4: 'H4',
                5: 'H5',
                6: 'H6',
                7: 'H7'
            };

            const filteredCards = filter === 'all'
                ? practiceCards
                : practiceCards.filter(c => c.habit === filter);

            filteredCards.forEach(card => {
                const cardEl = document.createElement('div');
                cardEl.className = 'card-mini';
                cardEl.innerHTML = `
                    <div class="card-mini-habit">${habitNames[card.habit]}</div>
                    <div class="card-mini-content">
                        <div class="card-mini-title">${card.title}</div>
                        <div class="card-mini-desc">${card.description}</div>
                    </div>
                    <div class="card-mini-fav" onclick="toggleFavorite(${card.id}, event)">â˜†</div>
                `;
                grid.appendChild(cardEl);
            });
        }

        function filterCards(habit) {
            document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            renderCardsGrid(habit);
        }

        function toggleFavorite(cardId, event) {
            event.stopPropagation();
            const favEl = event.currentTarget;
            favEl.classList.toggle('active');
            favEl.textContent = favEl.classList.contains('active') ? 'â˜…' : 'â˜†';
        }

        // ----------------------
        // PROFILE
        // ----------------------
        function updateProfileScreen() {
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileStreak').textContent = `${currentUser.streak || 0}æ—¥`;
            document.getElementById('profileTotal').textContent = `${currentUser.totalCheckins || 0}å›`;
            updateMonthlyDeclarationUI();
        }

        // ----------------------
        // MONTHLY DECLARATION
        // ----------------------
        function getCurrentMonth() {
            const now = new Date();
            return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
        }

        function getMonthLabel(monthKey) {
            const [year, month] = monthKey.split('-');
            return `${year}å¹´${parseInt(month)}æœˆ`;
        }

        function loadDeclarations() {
            const saved = localStorage.getItem('7habits_declarations');
            return saved ? JSON.parse(saved) : {};
        }

        function saveDeclarations(declarations) {
            localStorage.setItem('7habits_declarations', JSON.stringify(declarations));
        }

        function updateMonthlyDeclarationUI() {
            const currentMonth = getCurrentMonth();
            const declarations = loadDeclarations();

            // Update month label
            document.getElementById('currentMonthLabel').textContent = getMonthLabel(currentMonth);

            // Load current month's declaration
            const currentDeclaration = declarations[currentMonth] || '';
            document.getElementById('monthlyDeclarationInput').value = currentDeclaration;

            // Update header
            if (currentDeclaration) {
                document.getElementById('headerDeclaration').textContent = currentDeclaration;
                document.getElementById('monthlyDeclarationHeader').style.display = 'block';
            } else {
                document.getElementById('monthlyDeclarationHeader').style.display = 'none';
            }

            // Render history
            renderDeclarationHistory(declarations, currentMonth);
        }

        function renderDeclarationHistory(declarations, currentMonth) {
            const container = document.getElementById('declarationHistory');
            const sortedMonths = Object.keys(declarations)
                .filter(m => m !== currentMonth && declarations[m])
                .sort()
                .reverse();

            if (sortedMonths.length === 0) {
                container.innerHTML = '<div style="color:var(--text-gray); font-size:13px; text-align:center;">ã¾ã å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                return;
            }

            container.innerHTML = sortedMonths.map(month => `
                <div style="border-bottom:1px solid var(--light-gray); padding:12px 0;">
                    <div style="font-size:11px; color:var(--gold); margin-bottom:5px;">${getMonthLabel(month)}</div>
                    <div style="font-size:14px; color:var(--navy); line-height:1.5;">${declarations[month]}</div>
                </div>
            `).join('');
        }

        function saveMonthlyDeclaration() {
            const declaration = document.getElementById('monthlyDeclarationInput').value.trim();
            const currentMonth = getCurrentMonth();

            if (!declaration) {
                alert('å®£èª“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const declarations = loadDeclarations();
            declarations[currentMonth] = declaration;
            saveDeclarations(declarations);

            updateMonthlyDeclarationUI();
            alert('ä»Šæœˆã®å®£èª“ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼ğŸ“œ');
        }

        // ----------------------
        // START
        // ----------------------
        init();

        // ----------------------
        // 30 DAY CHALLENGE
        // ----------------------
        let challengeData = null;

        function initChallengeData() {
            const saved = localStorage.getItem('7habits_challenge');
            if (saved) {
                challengeData = JSON.parse(saved);
                updateChallengeUI();
            }
        }

        function startChallenge() {
            const today = new Date().toISOString().split('T')[0];
            challengeData = {
                startDate: today,
                days: {},
                completed: false
            };
            localStorage.setItem('7habits_challenge', JSON.stringify(challengeData));
            updateChallengeUI();
        }

        function updateChallengeUI() {
            if (!challengeData) {
                document.getElementById('challengeNotStarted').style.display = 'block';
                document.getElementById('challengeInProgress').style.display = 'none';
                document.getElementById('challengeCompleted').style.display = 'none';
                return;
            }

            const startDate = new Date(challengeData.startDate);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const daysPassed = Math.floor((today - startDate) / (1000 * 60 * 60 * 24)) + 1;
            const currentDay = Math.min(daysPassed, 30);

            if (challengeData.completed || daysPassed > 30) {
                showChallengeCompleted();
                return;
            }

            document.getElementById('challengeNotStarted').style.display = 'none';
            document.getElementById('challengeInProgress').style.display = 'block';
            document.getElementById('challengeCompleted').style.display = 'none';

            // Update stats
            const successCount = Object.values(challengeData.days).filter(d => d.proactive === true).length;
            const pendingCount = 30 - Object.keys(challengeData.days).length;
            document.getElementById('challengeDay').textContent = currentDay;
            document.getElementById('successCount').textContent = successCount;
            document.getElementById('pendingCount').textContent = pendingCount;

            // Render calendar
            renderChallengeCalendar(startDate, currentDay);

            // Today's reflection
            const todayStr = today.toISOString().split('T')[0];
            const todayData = challengeData.days[todayStr];

            // å¸¸ã«æŒ¯ã‚Šè¿”ã‚Šã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
            document.getElementById('todayReflectionCard').style.display = 'block';

            if (todayData) {
                // è¨˜éŒ²æ¸ˆã¿: è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰
                document.getElementById('reflectionStatusBadge').style.display = 'inline';
                document.getElementById('reflectionViewMode').style.display = 'block';
                document.getElementById('reflectionEditMode').style.display = 'none';

                // è¨˜éŒ²å†…å®¹ã‚’è¡¨ç¤º
                document.getElementById('viewProactiveIcon').textContent = todayData.proactive ? 'ğŸ˜Š' : 'ğŸ˜”';
                document.getElementById('viewProactiveText').textContent = todayData.proactive ? 'ä¸»ä½“çš„ã«éã”ã›ãŸ' : 'åå¿œçš„ã«ãªã£ã¦ã—ã¾ã£ãŸ';
                document.getElementById('viewNoteText').textContent = todayData.note || 'ãƒ¡ãƒ¢ãªã—';
            } else {
                // æœªè¨˜éŒ²: ç·¨é›†ãƒ¢ãƒ¼ãƒ‰
                document.getElementById('reflectionStatusBadge').style.display = 'none';
                document.getElementById('reflectionViewMode').style.display = 'none';
                document.getElementById('reflectionEditMode').style.display = 'block';
                document.getElementById('proactiveYes').classList.remove('selected');
                document.getElementById('proactiveNo').classList.remove('selected');
                document.getElementById('todayNote').value = '';
                document.getElementById('saveReflectionBtn').disabled = true;
            }
        }

        function renderChallengeCalendar(startDate, currentDay) {
            const calendar = document.getElementById('challengeCalendar');
            calendar.innerHTML = '';

            for (let i = 1; i <= 30; i++) {
                const dayDate = new Date(startDate);
                dayDate.setDate(startDate.getDate() + i - 1);
                const dateStr = dayDate.toISOString().split('T')[0];
                const dayData = challengeData.days[dateStr];

                const dayEl = document.createElement('div');
                dayEl.className = 'challenge-day';

                if (i === currentDay) {
                    dayEl.classList.add('today');
                } else if (i > currentDay) {
                    dayEl.classList.add('future');
                }

                let icon = '';
                if (dayData) {
                    if (dayData.proactive) {
                        dayEl.classList.add('success');
                        icon = 'âœ“';
                    } else {
                        dayEl.classList.add('fail');
                        icon = 'Ã—';
                    }
                }

                dayEl.innerHTML = `
                    <span class="challenge-day-num">${i}</span>
                    <span class="challenge-day-icon">${icon}</span>
                `;

                if (dayData && dayData.note) {
                    dayEl.title = dayData.note;
                }

                // Add click to view detail
                if (dayData) {
                    dayEl.style.cursor = 'pointer';
                    dayEl.onclick = () => showDayDetail(i, dateStr, dayData);
                }

                calendar.appendChild(dayEl);
            }
        }

        let todayProactive = null;

        // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
        function enableReflectionEdit() {
            const todayStr = new Date().toISOString().split('T')[0];
            const todayData = challengeData.days[todayStr];

            document.getElementById('reflectionViewMode').style.display = 'none';
            document.getElementById('reflectionEditMode').style.display = 'block';

            if (todayData) {
                // æ—¢å­˜ã®å€¤ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã«ã‚»ãƒƒãƒˆ
                todayProactive = todayData.proactive;
                document.getElementById('proactiveYes').classList.toggle('selected', todayData.proactive === true);
                document.getElementById('proactiveNo').classList.toggle('selected', todayData.proactive === false);
                document.getElementById('todayNote').value = todayData.note || '';
                document.getElementById('saveReflectionBtn').disabled = false;
                document.getElementById('saveReflectionBtn').textContent = 'æŒ¯ã‚Šè¿”ã‚Šã‚’æ›´æ–°';
            }
        }


        function showDayDetail(dayNum, dateStr, dayData) {
            document.getElementById('dayDetailIcon').textContent = dayData.proactive ? 'ğŸ˜Š' : 'ğŸ˜”';
            document.getElementById('dayDetailTitle').textContent = 'Day ' + dayNum;
            document.getElementById('dayDetailDate').textContent = dateStr;
            document.getElementById('dayDetailNote').textContent = dayData.note || 'ãƒ¡ãƒ¢ãŒã‚ã‚Šã¾ã›ã‚“';
            document.getElementById('dayDetailModal').classList.add('active');
        }

        function closeDayDetailModal() {
            document.getElementById('dayDetailModal').classList.remove('active');
        }

        function setTodayProactive(value) {
            todayProactive = value;
            document.getElementById('proactiveYes').classList.toggle('selected', value === true);
            document.getElementById('proactiveNo').classList.toggle('selected', value === false);
            document.getElementById('saveReflectionBtn').disabled = false;
        }

        async function saveTodayReflection() {
            if (todayProactive === null) {
                alert('ä¸»ä½“çš„ã ã£ãŸã‹ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }

            const today = new Date().toISOString().split('T')[0];
            const note = document.getElementById('todayNote').value.trim();

            challengeData.days[today] = {
                proactive: todayProactive,
                note: note
            };

            // Check if challenge is complete
            if (Object.keys(challengeData.days).length >= 30) {
                challengeData.completed = true;
            }

            localStorage.setItem('7habits_challenge', JSON.stringify(challengeData));

            // Sync to backend
            if (SCRIPT_URL) {
                try {
                    await fetch(SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'saveChallenge',
                            email: currentUser.email,
                            challenge: challengeData
                        })
                    });
                } catch (e) {
                    console.log('Backend sync skipped:', e);
                }
            }

            todayProactive = null;
            document.getElementById('saveReflectionBtn').textContent = 'æŒ¯ã‚Šè¿”ã‚Šã‚’ä¿å­˜';
            updateChallengeUI();
            alert('æŒ¯ã‚Šè¿”ã‚Šã‚’ä¿å­˜ã—ã¾ã—ãŸï¼ğŸ‰');
        }

        function showChallengeCompleted() {
            document.getElementById('challengeNotStarted').style.display = 'none';
            document.getElementById('challengeInProgress').style.display = 'none';
            document.getElementById('challengeCompleted').style.display = 'block';

            const successCount = Object.values(challengeData.days).filter(d => d.proactive === true).length;
            const rate = Math.round((successCount / 30) * 100);

            document.getElementById('finalSuccessCount').textContent = `${successCount}æ—¥`;
            document.getElementById('successRate').textContent = `${rate}%`;

            if (rate >= 80) {
                document.getElementById('completionMessage').textContent = 'ç´ æ™´ã‚‰ã—ã„ï¼ã‚ãªãŸã¯ä¸»ä½“æ€§ã®é”äººã§ã™ï¼ğŸ†';
            } else if (rate >= 50) {
                document.getElementById('completionMessage').textContent = 'ã‚ˆãé ‘å¼µã‚Šã¾ã—ãŸï¼æ¬¡å›ã¯ã•ã‚‰ã«é«˜ã¿ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼';
            } else {
                document.getElementById('completionMessage').textContent = 'æŒ‘æˆ¦ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚ã‚‚ã†ä¸€åº¦ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¾ã—ã‚‡ã†ï¼';
            }
        }

        function resetChallenge() {
            if (confirm('30æ—¥é–“ãƒ†ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ\nè¨˜éŒ²ã¯ã™ã¹ã¦æ¶ˆå»ã•ã‚Œã¾ã™ã€‚')) {
                localStorage.removeItem('7habits_challenge');
                challengeData = null;
                updateChallengeUI();
            }
        }

        // Initialize challenge on page load
        initChallengeData();
    </script>
</body>

</html>